---
import Layout from "@/layouts/Layout.astro";
import {
  experiences,
  education,
  languages,
  technologies,
  projects,
} from "../data/resume";
import ResumeTimeline from "@/components/ui/ResumeTimeline.astro";

import type { Experience, Education } from "../types/resume";
import Grid from "@/components/ui/Grid.astro";

let orderedExperiences: Experience[] = [];
let orderedEducations: Education[] = [];

const orderElement = <T extends { time: string }>(a: T, b: T) => {
  const presentValues = ["present", "now", "current", "today"];
  if (
    presentValues.includes(
      (a["time"] as string)?.split(" - ")[1]?.toLowerCase()
    )
  ) {
    // If the date is 'present', it should be the first element
    return -1;
  }
  const dateA = new Date((a["time"] as string)?.split(" - ")[1]);
  const dateB = new Date((b["time"] as string)?.split(" - ")[1]);
  return dateB.getTime() - dateA.getTime();
};

if (experiences.length > 0) {
  orderedExperiences = experiences.sort((a, b) => {
    return orderElement(a, b);
  });
}

if (education.length > 0) {
  orderedEducations = education.sort((a, b) => {
    return orderElement(a, b);
  });
}
---

<Layout title="Resume | Jania Vandevoorde">
  <div class="flex justify-end mb-8">
    <a
      href="/sep25.pdf"
      target="_blank"
      rel="noopener"
      class="group inline-flex items-center px-4 py-2 bg-secondary text-white rounded-lg hover:bg-accent transition"
    >
      <span class="inline-flex items-center justify-center w-8 h-8 bg-secondary rounded-full mr-2 transition group-hover:bg-accent">
        <!-- Open Icon (external link) -->
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 transition-transform duration-200 group-hover:scale-125"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <path d="M18 13v6a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" class="transition stroke-white group-hover:stroke-white"/>
          <polyline points="15 3 21 3 21 9" class="transition stroke-white group-hover:stroke-white"/>
          <line x1="10" y1="14" x2="21" y2="3" class="transition stroke-white group-hover:stroke-white"/>
        </svg>
      </span>
      Open Resume PDF
    </a>
  </div>
  <div class="max-w-3xl mx-auto">
    {
      orderedEducations.length > 0 && (
        <section class="mb-12">
          <h2 class="text-2xl font-bold mb-6 border-b pb-2 text-left">
            Education
          </h2>
          <ResumeTimeline elements={orderedEducations} colored={true} />
        </section>
      )
    }

    {
      orderedExperiences.length > 0 && (
        <section class="mb-12">
          <h2 class="text-2xl font-bold mb-6 border-b pb-2 text-left">
            Experiences
          </h2>
          <div id="experiences-container">
            <ResumeTimeline
              elements={orderedExperiences}
              colored={true}
            />
          </div>
        </section>
      )
    }
    {
      languages.length > 0 && (
        <section class="mb-12">
          <h2 class="text-2xl font-bold mb-6 border-b pb-2 text-left">
            Programming Languages
          </h2>
          <Grid gridTitle={undefined} gridItems={languages} />
        </section>
      )
    }
    {
      technologies.length > 0 && (
        <section class="mb-12">
          <h2 class="text-2xl font-bold mb-6 border-b pb-2 text-left">
            Technologies
          </h2>
          <Grid gridTitle={undefined} gridItems={technologies} />
        </section>
      )
    }
  </div>
</Layout>
