---
import Layout from "@/layouts/Layout.astro";
import {
  experiences,
  education,
  languages,
  technologies,
  projects,
} from "../data/resume";
import ResumeTimeline from "@/components/ui/ResumeTimeline.astro";

import type { Experience, Education } from "../types/resume";
import Grid from "@/components/ui/Grid.astro";

let orderedExperiences: Experience[] = [];
let orderedEducations: Education[] = [];

const orderElement = <T extends { time: string }>(a: T, b: T) => {
  const presentValues = ["present", "now", "current", "today"];
  if (
    presentValues.includes(
      (a["time"] as string)?.split(" - ")[1]?.toLowerCase()
    )
  ) {
    // If the date is 'present', it should be the first element
    return -1;
  }
  const dateA = new Date((a["time"] as string)?.split(" - ")[1]);
  const dateB = new Date((b["time"] as string)?.split(" - ")[1]);
  return dateB.getTime() - dateA.getTime();
};

if (experiences.length > 0) {
  orderedExperiences = experiences.sort((a, b) => {
    return orderElement(a, b);
  });
}

if (education.length > 0) {
  orderedEducations = education.sort((a, b) => {
    return orderElement(a, b);
  });
}
---

<Layout title="Resume | Jania Vandevoorde">
  <div class="max-w-3xl mx-auto">
    {
      orderedEducations.length > 0 && (
        <section class="mb-12">
          <h2 class="text-2xl font-bold mb-6 border-b pb-2 text-left">
            Education
          </h2>
          <ResumeTimeline elements={orderedEducations} colored={true} />
        </section>
      )
    }

    {
      orderedExperiences.length > 0 && (
        <section class="mb-12">
          <h2 class="text-2xl font-bold mb-6 border-b pb-2 text-left">
            Experiences
          </h2>
          <div id="experiences-container">
            <ResumeTimeline
              elements={orderedExperiences}
              colored={true}
            />
          </div>
        </section>
      )
    }
    {
      languages.length > 0 && (
        <section class="mb-12">
          <h2 class="text-2xl font-bold mb-6 border-b pb-2 text-left">
            Programming Languages
          </h2>
          <Grid gridTitle={undefined} gridItems={languages} />
        </section>
      )
    }
    {
      technologies.length > 0 && (
        <section class="mb-12">
          <h2 class="text-2xl font-bold mb-6 border-b pb-2 text-left">
            Technologies
          </h2>
          <Grid gridTitle={undefined} gridItems={technologies} />
        </section>
      )
    }
  </div>
</Layout>
